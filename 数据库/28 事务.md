### 28. 事务
#### 1. 什么是事务 ?
**事务**是一群可完成一组工作的SQL语句。在事务过程中，如果所有步骤无法不受干扰地完成，则不该完成任何单一步骤。

#### 2. ACID检测
为了帮助你判断SQL步骤是否为一个事务，可以借助ACID。这个简称由四个字符组成，是判断一组SQL语句是否构成一个事务的四个原则:
A: ATOMICITY
原子性。事务里的每一个步骤都必须完成，否则只能都不完成。
C: CONSISTENCY
一致性。事务完成后应该维持数据库的一致性。
I: ISOLATION
隔离性。表示每次事务都会看到具有一致性的数据库，无论其他事务有什么行动。
D: DURABILITY
持久性。事务完成后, 数据库需要正确地存储数据并保护数据免受断电或其他威胁的伤害。

#### 3. SQL如何帮助我们管理事务？
有三种SQL事务工具可以保障账户的安全:
```sql
START TRANSACTION; # 追踪SQL的行为
...
COMMIT; # 等到我们满意后再提交(COMMIT)所有程序代码造成的改变。
...

或者
START TRANSACTION;
...
ROLLBACK;
...
```
`START TRANSACTION`持续追踪后续所有的SQL语句，直到你输入`COMMIT`或`ROLLBACK`为止。如果所有语句都已经妥当, 改变后的结果似乎也不错, 那么请输入`COMMIT`,让一切改变为真。
如果改变结果不太对镜, `ROLLBACK`可以逆转过程, 让每件事回到`START TRANSACTION`前的状态。
```sql
# 改变表的存储引擎
ALTER TABLE your_table TYPE = InnoDB / BDB;
```
